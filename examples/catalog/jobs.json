{
  "bundles": [
    {
      "slug": "observatory-data-generator",
      "version": "0.2.0",
      "directory": "examples/environmental-observatory-event-driven/jobs/observatory-data-generator",
      "manifestPath": "examples/environmental-observatory-event-driven/jobs/observatory-data-generator/manifest.json",
      "jobDefinitionPath": "examples/environmental-observatory-event-driven/jobs/observatory-data-generator/job-definition.json",
      "manifest": {
        "name": "Observatory Data Generator",
        "version": "0.2.0",
        "entry": "dist/index.js",
        "runtime": "node18",
        "description": "Produces synthetic minute-level instrument CSVs and uploads them to Filestore.",
        "capabilities": [
          "fs",
          "network"
        ]
      },
      "definition": {
        "slug": "observatory-data-generator",
        "name": "Observatory Inbox Data Generator",
        "type": "batch",
        "runtime": "node",
        "entryPoint": "bundle:observatory-data-generator@0.2.0#handler",
        "timeoutMs": 120000,
        "retryPolicy": {
          "maxAttempts": 3,
          "strategy": "exponential",
          "initialDelayMs": 3000
        },
        "parametersSchema": {
          "type": "object",
          "properties": {
            "minute": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}$"
            },
            "rowsPerInstrument": {
              "type": "number",
              "minimum": 1,
              "maximum": 360
            },
            "intervalMinutes": {
              "type": "number",
              "minimum": 1,
              "maximum": 120
            },
            "instrumentCount": {
              "type": "number",
              "minimum": 1,
              "maximum": 50
            },
            "seed": {
              "type": "number"
            },
            "filestoreBaseUrl": {
              "type": "string",
              "minLength": 1
            },
            "filestoreBackendId": {
              "type": "number",
              "minimum": 1
            },
            "filestoreToken": {
              "type": "string"
            },
            "inboxPrefix": {
              "type": "string",
              "minLength": 1
            },
            "stagingPrefix": {
              "type": "string",
              "minLength": 1
            },
            "archivePrefix": {
              "type": "string",
              "minLength": 1
            },
            "principal": {
              "type": "string"
            },
            "metastoreBaseUrl": {
              "type": "string"
            },
            "metastoreNamespace": {
              "type": "string"
            },
            "metastoreAuthToken": {
              "type": "string"
            },
            "instrumentProfiles": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "instrumentId": {
                    "type": "string",
                    "minLength": 1
                  },
                  "site": {
                    "type": "string",
                    "minLength": 1
                  },
                  "baselineTemperatureC": {
                    "type": "number"
                  },
                  "baselineHumidityPct": {
                    "type": "number"
                  },
                  "baselinePm25UgM3": {
                    "type": "number"
                  },
                  "baselineBatteryVoltage": {
                    "type": "number"
                  }
                },
                "required": [
                  "instrumentId",
                  "site"
                ]
              },
              "minItems": 1
            }
          },
          "required": [
            "minute",
            "filestoreBaseUrl",
            "filestoreBackendId",
            "inboxPrefix",
            "stagingPrefix",
            "archivePrefix"
          ]
        },
        "defaultParameters": {
          "rowsPerInstrument": 6,
          "intervalMinutes": 10,
          "instrumentCount": 3,
          "filestoreBaseUrl": "http://127.0.0.1:4300",
          "filestoreBackendId": 1,
          "inboxPrefix": "datasets/observatory/inbox",
          "stagingPrefix": "datasets/observatory/staging",
          "archivePrefix": "datasets/observatory/archive",
          "principal": "observatory-data-generator",
          "metastoreBaseUrl": null,
          "metastoreNamespace": "observatory.ingest",
          "metastoreAuthToken": null
        },
        "outputSchema": {
          "type": "object",
          "properties": {
            "partitionKey": {
              "type": "string"
            },
            "generated": {
              "type": "object",
              "properties": {
                "generatedAt": {
                  "type": "string",
                  "format": "date-time"
                },
                "partitionKey": {
                  "type": "string"
                },
                "filestoreInboxPrefix": {
                  "type": "string"
                },
                "filestoreBackendId": {
                  "type": "number"
                },
                "seed": {
                  "type": "number"
                },
                "rowsGenerated": {
                  "type": "number"
                },
                "instrumentCount": {
                  "type": "number"
                },
                "files": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "instrumentId": {
                        "type": "string"
                      },
                      "site": {
                        "type": "string"
                      },
                      "relativePath": {
                        "type": "string"
                      },
                      "filestorePath": {
                        "type": "string"
                      },
                      "rows": {
                        "type": "number"
                      },
                      "firstTimestamp": {
                        "type": "string",
                        "format": "date-time"
                      },
                      "lastTimestamp": {
                        "type": "string",
                        "format": "date-time"
                      }
                    },
                    "required": [
                      "instrumentId",
                      "relativePath",
                      "filestorePath",
                      "rows"
                    ]
                  }
                }
              },
              "required": [
                "generatedAt",
                "partitionKey",
                "filestoreInboxPrefix",
                "filestoreBackendId",
                "seed",
                "rowsGenerated",
                "instrumentCount",
                "files"
              ]
            },
            "assets": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "assetId": {
                    "type": "string"
                  },
                  "partitionKey": {
                    "type": "string"
                  },
                  "producedAt": {
                    "type": "string",
                    "format": "date-time"
                  }
                },
                "required": [
                  "assetId",
                  "partitionKey",
                  "producedAt"
                ]
              }
            }
          },
          "required": [
            "partitionKey",
            "generated"
          ]
        }
      }
    },
    {
      "slug": "observatory-inbox-normalizer",
      "version": "0.1.0",
      "directory": "examples/environmental-observatory-event-driven/jobs/observatory-inbox-normalizer",
      "manifestPath": "examples/environmental-observatory-event-driven/jobs/observatory-inbox-normalizer/manifest.json",
      "jobDefinitionPath": "examples/environmental-observatory-event-driven/jobs/observatory-inbox-normalizer/job-definition.json",
      "manifest": {
        "name": "Observatory Inbox Normalizer",
        "version": "0.1.0",
        "entry": "dist/index.js",
        "runtime": "node18",
        "description": "Copies minute-level instrument CSVs into staging, archives the originals, and emits normalized observatory.timeseries.raw assets.",
        "capabilities": [
          "fs",
          "network"
        ]
      },
      "definition": {
        "slug": "observatory-inbox-normalizer",
        "name": "Observatory Inbox Normalizer",
        "type": "batch",
        "runtime": "node",
        "entryPoint": "bundle:observatory-inbox-normalizer@0.1.0#handler",
        "timeoutMs": 120000,
        "retryPolicy": {
          "maxAttempts": 3,
          "strategy": "exponential",
          "initialDelayMs": 5000
        },
        "parametersSchema": {
          "type": "object",
          "properties": {
            "stagingDir": {
              "type": "string",
              "minLength": 1
            },
            "archiveDir": {
              "type": "string",
              "minLength": 1
            },
            "minute": {
              "type": "string",
              "minLength": 1
            },
            "maxFiles": {
              "type": "number",
              "minimum": 1,
              "maximum": 2000
            },
            "commandPath": {
              "type": "string"
            },
            "filestoreBaseUrl": {
              "type": "string",
              "minLength": 1
            },
            "filestoreBackendId": {
              "type": "number",
              "minimum": 1
            },
            "filestoreToken": {
              "type": "string"
            },
            "inboxPrefix": {
              "type": "string",
              "minLength": 1
            },
            "stagingPrefix": {
              "type": "string",
              "minLength": 1
            },
            "archivePrefix": {
              "type": "string",
              "minLength": 1
            },
            "principal": {
              "type": "string"
            },
            "metastoreBaseUrl": {
              "type": "string"
            },
            "metastoreNamespace": {
              "type": "string"
            },
            "metastoreAuthToken": {
              "type": "string"
            }
          },
          "required": [
            "stagingDir",
            "archiveDir",
            "minute",
            "filestoreBaseUrl",
            "filestoreBackendId",
            "inboxPrefix",
            "stagingPrefix",
            "archivePrefix"
          ]
        },
        "defaultParameters": {
          "maxFiles": 1000,
          "stagingDir": "examples/environmental-observatory-event-driven/data/staging",
          "archiveDir": "examples/environmental-observatory-event-driven/data/archive",
          "filestoreBaseUrl": "http://127.0.0.1:4300",
          "filestoreBackendId": 1,
          "inboxPrefix": "datasets/observatory/inbox",
          "stagingPrefix": "datasets/observatory/staging",
          "archivePrefix": "datasets/observatory/archive",
          "principal": "observatory-inbox-normalizer",
          "metastoreBaseUrl": null,
          "metastoreNamespace": "observatory.ingest",
          "metastoreAuthToken": null
        },
        "outputSchema": {
          "type": "object",
          "properties": {
            "partitionKey": {
              "type": "string"
            },
            "minute": {
              "type": "string"
            },
            "instrumentCount": {
              "type": "number"
            },
            "recordCount": {
              "type": "number"
            },
            "sourceFiles": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "relativePath": {
                    "type": "string"
                  },
                  "site": {
                    "type": "string"
                  },
                  "instrumentId": {
                    "type": "string"
                  },
                  "rows": {
                    "type": "number"
                  }
                },
                "required": [
                  "relativePath",
                  "rows"
                ]
              }
            },
            "stagingDir": {
              "type": "string"
            },
            "normalizedAt": {
              "type": "string",
              "format": "date-time"
            }
          },
          "required": [
            "partitionKey",
            "minute",
            "recordCount",
            "sourceFiles",
            "normalizedAt"
          ]
        }
      }
    },
    {
      "slug": "observatory-timestore-loader",
      "version": "0.1.0",
      "directory": "examples/environmental-observatory-event-driven/jobs/observatory-timestore-loader",
      "manifestPath": "examples/environmental-observatory-event-driven/jobs/observatory-timestore-loader/manifest.json",
      "jobDefinitionPath": "examples/environmental-observatory-event-driven/jobs/observatory-timestore-loader/job-definition.json",
      "manifest": {
        "name": "Observatory Timestore Loader",
        "version": "0.1.0",
        "entry": "dist/index.js",
        "runtime": "node18",
        "description": "Ingests normalized observatory readings into Timestore and emits observatory.timeseries.timestore assets.",
        "capabilities": [
          "fs",
          "network"
        ]
      },
      "definition": {
        "slug": "observatory-timestore-loader",
        "name": "Observatory Timestore Loader",
        "type": "batch",
        "runtime": "node",
        "entryPoint": "bundle:observatory-timestore-loader@0.1.0#handler",
        "timeoutMs": 180000,
        "retryPolicy": {
          "maxAttempts": 3,
          "strategy": "exponential",
          "initialDelayMs": 10000
        },
        "parametersSchema": {
          "type": "object",
          "properties": {
            "datasetSlug": {
              "type": "string",
              "minLength": 1
            },
            "datasetName": {
              "type": "string",
              "minLength": 1
            },
            "tableName": {
              "type": "string",
              "minLength": 1
            },
            "timestoreBaseUrl": {
              "type": "string",
              "minLength": 1
            },
            "timestoreAuthToken": {
              "type": "string"
            },
            "storageTargetId": {
              "type": "string"
            },
            "partitionNamespace": {
              "type": "string"
            },
            "minute": {
              "type": "string",
              "minLength": 1
            },
            "rawAsset": {
              "type": "object"
            },
            "idempotencyKey": {
              "type": "string",
              "minLength": 1
            }
          },
          "required": [
            "datasetSlug",
            "tableName",
            "timestoreBaseUrl",
            "minute",
            "rawAsset"
          ]
        },
        "defaultParameters": {
          "tableName": "observations",
          "partitionNamespace": "observatory"
        },
        "outputSchema": {
          "type": "object",
          "properties": {
            "partitionKey": {
              "type": "string"
            },
            "datasetSlug": {
              "type": "string"
            },
            "ingestionMode": {
              "type": "string"
            },
            "manifestId": {
              "type": "string"
            },
            "datasetId": {
              "type": "string"
            },
            "rowCount": {
              "type": "number"
            },
            "storageTargetId": {
              "type": "string"
            }
          },
          "required": [
            "partitionKey",
            "datasetSlug",
            "rowCount"
          ]
        }
      }
    },
    {
      "slug": "observatory-visualization-runner",
      "version": "0.1.0",
      "directory": "examples/environmental-observatory-event-driven/jobs/observatory-visualization-runner",
      "manifestPath": "examples/environmental-observatory-event-driven/jobs/observatory-visualization-runner/manifest.json",
      "jobDefinitionPath": "examples/environmental-observatory-event-driven/jobs/observatory-visualization-runner/job-definition.json",
      "manifest": {
        "name": "Observatory Visualization Runner",
        "version": "0.1.0",
        "entry": "dist/index.js",
        "runtime": "node18",
        "description": "Queries Timestore for aggregates, builds SVG plots, and emits observatory visualization assets.",
        "capabilities": [
          "fs",
          "network"
        ]
      },
      "definition": {
        "slug": "observatory-visualization-runner",
        "name": "Observatory Visualization Runner",
        "type": "batch",
        "runtime": "node",
        "entryPoint": "bundle:observatory-visualization-runner@0.1.0#handler",
        "timeoutMs": 150000,
        "retryPolicy": {
          "maxAttempts": 2,
          "strategy": "fixed",
          "initialDelayMs": 10000
        },
        "parametersSchema": {
          "type": "object",
          "properties": {
            "timestoreBaseUrl": {
              "type": "string",
              "minLength": 1
            },
            "timestoreDatasetSlug": {
              "type": "string",
              "minLength": 1
            },
            "timestoreAuthToken": {
              "type": "string"
            },
            "plotsDir": {
              "type": "string",
              "minLength": 1
            },
            "partitionKey": {
              "type": "string",
              "minLength": 1
            },
            "instrumentId": {
              "type": "string"
            },
            "lookbackMinutes": {
              "type": "number",
              "minimum": 1,
              "maximum": 10080
            },
            "siteFilter": {
              "type": "string"
            }
          },
          "required": [
            "timestoreBaseUrl",
            "timestoreDatasetSlug",
            "plotsDir",
            "partitionKey",
            "instrumentId"
          ]
        },
        "defaultParameters": {
          "lookbackMinutes": 180,
          "instrumentId": null
        },
        "outputSchema": {
          "type": "object",
          "properties": {
            "generatedAt": {
              "type": "string",
              "format": "date-time"
            },
            "partitionKey": {
              "type": "string"
            },
            "plotsDir": {
              "type": "string"
            },
            "lookbackMinutes": {
              "type": "number"
            },
            "artifacts": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "relativePath": {
                    "type": "string"
                  },
                  "mediaType": {
                    "type": "string"
                  },
                  "description": {
                    "type": "string"
                  },
                  "sizeBytes": {
                    "type": "number"
                  }
                },
                "required": [
                  "relativePath",
                  "mediaType"
                ]
              }
            },
            "metrics": {
              "type": "object",
              "additionalProperties": true
            }
          },
          "required": [
            "generatedAt",
            "partitionKey",
            "plotsDir",
            "artifacts"
          ]
        }
      }
    },
    {
      "slug": "observatory-report-publisher",
      "version": "0.1.0",
      "directory": "examples/environmental-observatory-event-driven/jobs/observatory-report-publisher",
      "manifestPath": "examples/environmental-observatory-event-driven/jobs/observatory-report-publisher/manifest.json",
      "jobDefinitionPath": "examples/environmental-observatory-event-driven/jobs/observatory-report-publisher/job-definition.json",
      "manifest": {
        "name": "Observatory Report Publisher",
        "version": "0.1.0",
        "entry": "dist/index.js",
        "runtime": "node18",
        "description": "Publishes Markdown, HTML, and JSON status reports and optionally upserts them into the metastore.",
        "capabilities": [
          "fs",
          "network"
        ]
      },
      "definition": {
        "slug": "observatory-report-publisher",
        "name": "Observatory Report Publisher",
        "type": "batch",
        "runtime": "node",
        "entryPoint": "bundle:observatory-report-publisher@0.1.0#handler",
        "timeoutMs": 180000,
        "retryPolicy": {
          "maxAttempts": 2,
          "strategy": "fixed",
          "initialDelayMs": 15000
        },
        "parametersSchema": {
          "type": "object",
          "properties": {
            "reportsDir": {
              "type": "string",
              "minLength": 1
            },
            "plotsDir": {
              "type": "string",
              "minLength": 1
            },
            "partitionKey": {
              "type": "string",
              "minLength": 1
            },
            "instrumentId": {
              "type": "string"
            },
            "reportTemplate": {
              "type": "string"
            },
            "visualizationAsset": {
              "type": "object"
            },
            "metastoreBaseUrl": {
              "type": "string"
            },
            "metastoreAuthToken": {
              "type": "string"
            },
            "metastoreNamespace": {
              "type": "string"
            }
          },
          "required": [
            "reportsDir",
            "plotsDir",
            "partitionKey",
            "instrumentId",
            "visualizationAsset"
          ]
        },
        "outputSchema": {
          "type": "object",
          "properties": {
            "generatedAt": {
              "type": "string",
              "format": "date-time"
            },
            "reportsDir": {
              "type": "string"
            },
            "reportFiles": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "relativePath": {
                    "type": "string"
                  },
                  "mediaType": {
                    "type": "string"
                  },
                  "sizeBytes": {
                    "type": "number"
                  }
                },
                "required": [
                  "relativePath",
                  "mediaType"
                ]
              }
            },
            "summary": {
              "type": "object",
              "properties": {
                "instrumentCount": {
                  "type": "number"
                },
                "siteCount": {
                  "type": "number"
                },
                "alertCount": {
                  "type": "number"
                }
              }
            },
            "plotsReferenced": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "relativePath": {
                    "type": "string"
                  },
                  "altText": {
                    "type": "string"
                  }
                },
                "required": [
                  "relativePath"
                ]
              }
            },
            "instrumentId": {
              "type": "string"
            }
          },
          "required": [
            "generatedAt",
            "reportsDir",
            "reportFiles",
            "instrumentId"
          ]
        }
      }
    },
    {
      "slug": "observatory-calibration-importer",
      "version": "0.1.0",
      "directory": "examples/environmental-observatory-event-driven/jobs/observatory-calibration-importer",
      "manifestPath": "examples/environmental-observatory-event-driven/jobs/observatory-calibration-importer/manifest.json",
      "jobDefinitionPath": "examples/environmental-observatory-event-driven/jobs/observatory-calibration-importer/job-definition.json",
      "manifest": {
        "name": "Observatory Calibration Importer",
        "version": "0.1.0",
        "entry": "dist/index.js",
        "runtime": "node18",
        "description": "Parses calibration uploads from Filestore, writes canonical records to the Metastore, and emits observatory.calibration.updated events.",
        "capabilities": [
          "network"
        ]
      },
      "definition": {
        "slug": "observatory-calibration-importer",
        "name": "Observatory Calibration Importer",
        "type": "batch",
        "runtime": "node",
        "entryPoint": "bundle:observatory-calibration-importer@0.1.0#handler",
        "timeoutMs": 60000,
        "retryPolicy": {
          "maxAttempts": 3,
          "strategy": "fixed",
          "initialDelayMs": 10000
        },
        "parametersSchema": {
          "type": "object",
          "properties": {
            "filestoreBaseUrl": {
              "type": "string",
              "minLength": 1
            },
            "filestoreBackendId": {
              "type": "number",
              "minimum": 1
            },
            "filestoreToken": {
              "type": "string"
            },
            "filestorePrincipal": {
              "type": "string"
            },
            "calibrationPath": {
              "type": "string",
              "minLength": 1
            },
            "calibrationNodeId": {
              "type": "number",
              "minimum": 1
            },
            "calibrationsPrefix": {
              "type": "string",
              "minLength": 1
            },
            "checksum": {
              "type": "string"
            },
            "metastoreBaseUrl": {
              "type": "string",
              "minLength": 1
            },
            "metastoreNamespace": {
              "type": "string",
              "minLength": 1
            },
            "metastoreAuthToken": {
              "type": "string"
            }
          },
          "required": [
            "filestoreBaseUrl",
            "filestoreBackendId",
            "calibrationPath",
            "metastoreBaseUrl"
          ]
        },
        "defaultParameters": {
          "filestoreBaseUrl": "http://127.0.0.1:4300",
          "filestoreBackendId": 1,
          "filestoreToken": null,
          "filestorePrincipal": "observatory-calibration-importer",
          "calibrationsPrefix": "datasets/observatory/calibrations",
          "metastoreBaseUrl": "http://127.0.0.1:4100",
          "metastoreNamespace": "observatory.calibrations",
          "metastoreAuthToken": null
        },
        "outputSchema": {
          "type": "object",
          "properties": {
            "calibrationId": {
              "type": "string"
            },
            "instrumentId": {
              "type": "string"
            },
            "effectiveAt": {
              "type": "string",
              "format": "date-time"
            },
            "metastoreRecordKey": {
              "type": "string"
            },
            "metastoreVersion": {
              "type": [
                "number",
                "null"
              ]
            },
            "assets": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "assetId": {
                    "type": "string"
                  },
                  "partitionKey": {
                    "type": "string"
                  },
                  "producedAt": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "payload": {
                    "type": "object",
                    "additionalProperties": true
                  }
                },
                "required": [
                  "assetId",
                  "partitionKey",
                  "producedAt",
                  "payload"
                ]
              }
            }
          },
          "required": [
            "calibrationId",
            "instrumentId",
            "effectiveAt",
            "metastoreRecordKey"
          ]
        }
      }
    },
    {
      "slug": "observatory-calibration-planner",
      "version": "0.1.0",
      "directory": "examples/environmental-observatory-event-driven/jobs/observatory-calibration-planner",
      "manifestPath": "examples/environmental-observatory-event-driven/jobs/observatory-calibration-planner/manifest.json",
      "jobDefinitionPath": "examples/environmental-observatory-event-driven/jobs/observatory-calibration-planner/job-definition.json",
      "manifest": {
        "name": "Observatory Calibration Planner",
        "version": "0.1.0",
        "entry": "dist/index.js",
        "runtime": "node18",
        "description": "Builds calibration reprocessing plans by comparing ingest partitions against updated calibration records and storing plan artifacts in Filestore.",
        "capabilities": [
          "network"
        ]
      },
      "definition": {
        "slug": "observatory-calibration-planner",
        "name": "Observatory Calibration Planner",
        "type": "batch",
        "runtime": "node",
        "entryPoint": "bundle:observatory-calibration-planner@0.1.0#handler",
        "timeoutMs": 180000,
        "retryPolicy": {
          "maxAttempts": 2,
          "strategy": "exponential",
          "initialDelayMs": 5000
        },
        "parametersSchema": {
          "type": "object",
          "properties": {
            "calibrations": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "calibrationId": {
                    "type": "string"
                  },
                  "instrumentId": {
                    "type": "string",
                    "minLength": 1
                  },
                  "effectiveAt": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "metastoreVersion": {
                    "type": [
                      "number",
                      "null"
                    ]
                  }
                },
                "required": [
                  "instrumentId",
                  "effectiveAt"
                ]
              }
            },
            "catalogBaseUrl": {
              "type": "string",
              "minLength": 1
            },
            "catalogApiToken": {
              "type": "string"
            },
            "ingestWorkflowSlug": {
              "type": "string",
              "minLength": 1
            },
            "ingestAssetId": {
              "type": "string",
              "minLength": 1
            },
            "downstreamWorkflows": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "workflowSlug": {
                    "type": "string",
                    "minLength": 1
                  },
                  "description": {
                    "type": "string"
                  },
                  "assetIds": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  }
                },
                "required": [
                  "workflowSlug"
                ]
              }
            },
            "plansPrefix": {
              "type": "string",
              "minLength": 1
            },
            "planId": {
              "type": "string"
            },
            "planFileName": {
              "type": "string"
            },
            "filestoreBaseUrl": {
              "type": "string",
              "minLength": 1
            },
            "filestoreBackendId": {
              "type": "number",
              "minimum": 1
            },
            "filestoreToken": {
              "type": "string"
            },
            "filestorePrincipal": {
              "type": "string"
            },
            "metastoreBaseUrl": {
              "type": "string"
            },
            "metastoreNamespace": {
              "type": "string"
            },
            "metastoreAuthToken": {
              "type": "string"
            },
            "lookback": {
              "type": "number",
              "minimum": 1,
              "maximum": 10000
            }
          },
          "required": [
            "calibrations",
            "catalogBaseUrl",
            "ingestWorkflowSlug",
            "ingestAssetId",
            "plansPrefix",
            "filestoreBaseUrl",
            "filestoreBackendId"
          ]
        },
        "defaultParameters": {
          "catalogBaseUrl": "http://127.0.0.1:4000",
          "catalogApiToken": null,
          "ingestWorkflowSlug": "observatory-minute-ingest",
          "ingestAssetId": "observatory.timeseries.timestore",
          "downstreamWorkflows": [
            {
              "workflowSlug": "observatory-daily-publication"
            },
            {
              "workflowSlug": "observatory-dashboard-aggregate"
            }
          ],
          "plansPrefix": "datasets/observatory/calibrations/plans",
          "filestoreBaseUrl": "http://127.0.0.1:4300",
          "filestoreBackendId": 1,
          "filestoreToken": null,
          "filestorePrincipal": "observatory-calibration-planner",
          "metastoreBaseUrl": null,
          "metastoreNamespace": "observatory.reprocess.plans",
          "metastoreAuthToken": null
        },
        "outputSchema": {
          "type": "object",
          "properties": {
            "planId": {
              "type": "string"
            },
            "planPath": {
              "type": "string"
            },
            "planNodeId": {
              "type": [
                "number",
                "null"
              ]
            },
            "partitionCount": {
              "type": "number"
            },
            "instrumentCount": {
              "type": "number"
            },
            "calibrationCount": {
              "type": "number"
            },
            "state": {
              "type": "string"
            },
            "storage": {
              "type": "object",
              "properties": {
                "plansPrefix": {
                  "type": [
                    "string",
                    "null"
                  ]
                },
                "planPath": {
                  "type": "string"
                },
                "nodeId": {
                  "type": [
                    "number",
                    "null"
                  ]
                }
              },
              "required": [
                "planPath"
              ]
            },
            "summary": {
              "type": "object",
              "properties": {
                "partitionCount": {
                  "type": "number"
                },
                "instrumentCount": {
                  "type": "number"
                },
                "calibrationCount": {
                  "type": "number"
                }
              },
              "required": [
                "partitionCount",
                "instrumentCount",
                "calibrationCount"
              ]
            },
            "assets": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "assetId": {
                    "type": "string"
                  },
                  "partitionKey": {
                    "type": [
                      "string",
                      "null"
                    ]
                  },
                  "producedAt": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "payload": {
                    "type": "object",
                    "additionalProperties": true
                  }
                },
                "required": [
                  "assetId",
                  "producedAt",
                  "payload"
                ]
              }
            }
          },
          "required": [
            "planId",
            "planPath",
            "partitionCount",
            "calibrationCount",
            "summary",
            "assets"
          ]
        }
      }
    },
    {
      "slug": "observatory-calibration-reprocessor",
      "version": "0.1.0",
      "directory": "examples/environmental-observatory-event-driven/jobs/observatory-calibration-reprocessor",
      "manifestPath": "examples/environmental-observatory-event-driven/jobs/observatory-calibration-reprocessor/manifest.json",
      "jobDefinitionPath": "examples/environmental-observatory-event-driven/jobs/observatory-calibration-reprocessor/job-definition.json",
      "manifest": {
        "name": "Observatory Calibration Reprocessor",
        "version": "0.1.0",
        "entry": "dist/index.js",
        "runtime": "node18",
        "description": "Consumes calibration reprocessing plans, queues ingest workflow reruns with bounded concurrency, and updates plan status artifacts as runs complete.",
        "capabilities": [
          "network"
        ]
      },
      "definition": {
        "slug": "observatory-calibration-reprocessor",
        "name": "Observatory Calibration Reprocessor",
        "type": "batch",
        "runtime": "node",
        "entryPoint": "bundle:observatory-calibration-reprocessor@0.1.0#handler",
        "timeoutMs": 300000,
        "retryPolicy": {
          "maxAttempts": 1,
          "strategy": "exponential",
          "initialDelayMs": 5000
        },
        "parametersSchema": {
          "type": "object",
          "properties": {
            "planPath": {
              "type": "string"
            },
            "planNodeId": {
              "type": "number",
              "minimum": 1
            },
            "planId": {
              "type": "string"
            },
            "mode": {
              "type": "string",
              "enum": [
                "all",
                "selected"
              ]
            },
            "selectedPartitions": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              }
            },
            "maxConcurrency": {
              "type": "number",
              "minimum": 1,
              "maximum": 10
            },
            "pollIntervalMs": {
              "type": "number",
              "minimum": 250,
              "maximum": 10000
            },
            "catalogBaseUrl": {
              "type": "string",
              "minLength": 1
            },
            "catalogApiToken": {
              "type": "string"
            },
            "ingestWorkflowSlug": {
              "type": "string",
              "minLength": 1
            },
            "filestoreBaseUrl": {
              "type": "string",
              "minLength": 1
            },
            "filestoreBackendId": {
              "type": "number",
              "minimum": 1
            },
            "filestoreToken": {
              "type": "string"
            },
            "filestorePrincipal": {
              "type": "string"
            },
            "metastoreBaseUrl": {
              "type": "string"
            },
            "metastoreNamespace": {
              "type": "string"
            },
            "metastoreAuthToken": {
              "type": "string"
            }
          },
          "required": [
            "catalogBaseUrl",
            "ingestWorkflowSlug",
            "filestoreBaseUrl",
            "filestoreBackendId"
          ]
        },
        "defaultParameters": {
          "mode": "all",
          "maxConcurrency": 3,
          "pollIntervalMs": 1500,
          "catalogBaseUrl": "http://127.0.0.1:4000",
          "catalogApiToken": null,
          "ingestWorkflowSlug": "observatory-minute-ingest",
          "filestoreBaseUrl": "http://127.0.0.1:4300",
          "filestoreBackendId": 1,
          "filestoreToken": null,
          "filestorePrincipal": "observatory-calibration-reprocessor",
          "metastoreBaseUrl": null,
          "metastoreNamespace": "observatory.reprocess.plans",
          "metastoreAuthToken": null
        },
        "outputSchema": {
          "type": "object",
          "properties": {
            "planId": {
              "type": "string"
            },
            "planPath": {
              "type": "string"
            },
            "processedPartitions": {
              "type": "number"
            },
            "succeeded": {
              "type": "number"
            },
            "failed": {
              "type": "number"
            },
            "mode": {
              "type": "string"
            },
            "state": {
              "type": "string"
            },
            "runs": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "partitionKey": {
                    "type": [
                      "string",
                      "null"
                    ]
                  },
                  "minute": {
                    "type": [
                      "string",
                      "null"
                    ]
                  },
                  "runId": {
                    "type": [
                      "string",
                      "null"
                    ]
                  },
                  "status": {
                    "type": "string"
                  },
                  "errorMessage": {
                    "type": [
                      "string",
                      "null"
                    ]
                  }
                },
                "required": [
                  "status"
                ]
              }
            },
            "assets": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "assetId": {
                    "type": "string"
                  },
                  "partitionKey": {
                    "type": [
                      "string",
                      "null"
                    ]
                  },
                  "producedAt": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "payload": {
                    "type": "object",
                    "additionalProperties": true
                  }
                },
                "required": [
                  "assetId",
                  "producedAt",
                  "payload"
                ]
              }
            }
          },
          "required": [
            "planId",
            "processedPartitions",
            "succeeded",
            "failed",
            "state",
            "assets"
          ]
        }
      }
    }
  ]
}
