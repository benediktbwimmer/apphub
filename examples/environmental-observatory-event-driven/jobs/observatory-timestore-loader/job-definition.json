{
  "slug": "observatory-timestore-loader",
  "name": "Observatory Timestore Loader",
  "type": "batch",
  "runtime": "node",
  "entryPoint": "bundle:observatory-timestore-loader@0.2.0#handler",
  "timeoutMs": 180000,
  "retryPolicy": {
    "maxAttempts": 3,
    "strategy": "exponential",
    "initialDelayMs": 10000
  },
  "parametersSchema": {
    "type": "object",
    "properties": {
      "datasetSlug": { "type": "string", "minLength": 1 },
      "datasetName": { "type": "string", "minLength": 1 },
      "tableName": { "type": "string", "minLength": 1 },
      "timestoreBaseUrl": { "type": "string", "minLength": 1 },
      "timestoreAuthToken": { "type": "string" },
      "storageTargetId": { "type": "string" },
      "partitionNamespace": { "type": "string" },
      "minute": { "type": "string", "minLength": 1 },
      "rawAsset": { "type": ["object", "null"] },
      "idempotencyKey": { "type": "string", "minLength": 1 },
      "calibrationsBaseUrl": { "type": "string" },
      "calibrationsNamespace": { "type": "string" },
      "calibrationsAuthToken": { "type": "string" }
    },
    "required": ["datasetSlug", "tableName", "timestoreBaseUrl", "minute"]
  },
  "defaultParameters": {
    "tableName": "observations",
    "partitionNamespace": "observatory",
    "calibrationsBaseUrl": null,
    "calibrationsNamespace": "observatory.calibrations",
    "calibrationsAuthToken": null
  },
  "outputSchema": {
    "type": "object",
    "properties": {
      "partitionKey": { "type": "string" },
      "datasetSlug": { "type": "string" },
      "ingestionMode": { "type": "string" },
      "manifestId": { "type": "string" },
      "datasetId": { "type": "string" },
      "rowCount": { "type": "number" },
      "storageTargetId": { "type": "string" },
      "calibrationId": { "type": ["string", "null"] },
      "calibrationEffectiveAt": { "type": ["string", "null"], "format": "date-time" },
      "calibrationMetastoreVersion": { "type": ["number", "null"] }
    },
    "required": ["partitionKey", "datasetSlug", "rowCount"]
  }
}
